---
title: "Analyse descriptive du mix cultural de la Bretagne (2007-2023)"
author: "Aziliz Joseph dit Pagny, In√®s Bezie et Lo√Øc Henry"
date: "2025-06-12"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
```

```{r environment-preparation, include=FALSE}
# Clean memory 
rm(list=ls())
gc()

# Load package
if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, data.table, here, sf, tmap, units, knitr, kableExtra, plotly)

# List directories 
dir <- list()
dir$root <- here()
dir$data <- here(dir$root, "data")
dir$raw <- here(dir$data, "raw")
dir$derived <- here(dir$data, "derived")
dir$final <- here(dir$data, "final")
dir$script <- here(dir$root, "script")
dir$output <- here(dir$root, "output")

# Create non existing directories
lapply(dir, function(i) dir.create(i, recursive = T, showWarnings = F))

```

```{r color-palette, include=FALSE}
c25 <- c(
  "dodgerblue2", "#E31A1C", # red
  "green4",
  "#6A3D9A", # purple
  "#FF7F00", # orange
  "black", "gold1",
  "skyblue2", "#FB9A99", # lt pink
  "palegreen2",
  "#CAB2D6", # lt purple
  "#FDBF6F", # lt orange
  "gray70", "khaki2",
  "maroon", "orchid1", "deeppink1", "blue1", "steelblue4",
  "darkturquoise", "green1", "yellow4", "yellow3",
  "darkorange4", "brown"
)

```

## Introduction

Ce document pr√©sente la r√©partition des cultures en Bretagne √† partir des donn√©es du **Registre Parcellaire Graphique** (RPG). Le RPG est une base de donn√©es g√©ographique qui recense les parcelles agricoles et les cultures qui y sont pratiqu√©es. Ces donn√©es sont d√©clar√©es par les agriculteurs dans le cadre de leur d√©claration de la Politique Agricole Commune. Elles sont en [libre acc√®s](https://geoservices.ign.fr/rpg) et sont mises √† jour chaque ann√©e. 

L'objectif de cette analyse est de visualiser la diversit√© des cultures pratiqu√©es en Bretagne et d'identifier les principales cultures pr√©sentes dans la r√©gion. En particulier, nous souhaitons identifier les dynamiques des cultures (cultures √©mergentes ou en d√©clin) ainsi que leur r√©partition spatiale. Cette analyse utilise les donn√©es du RPG sur 17 ann√©es (2007-2023), aggr√©g√©es √† l'√©chelle de la commune. Les scripts permettant de collecter, et pr√©parer les donn√©es du RPG sont disponibles sur GitHub dans le d√©p√¥ts [`RPG_PrepareData`](https://github.com/loichy/RPG_PrepareData) Nous disposons ainsi de l'usage des sols entre 24 et 28 grands groupes de culture. Nous mesurons la surface d√©di√© √† chaque groupe de culture par commune et ann√©e, ainsi que le nombre de parcelles.

Dans une premi√®re partie, nous pr√©sentons l'usage des sols de mani√®re globale en Bretagne sur la p√©riode 2007-2023. Dans la deuxi√®me section, nous √©tudions la dynamique des usages des sols, en √©tudiant en particulier l'expansion des cultures √©mergentes et le d√©clin des cultures en perte de vitesse. Enfin, nous √©tudions la diversit√© des cultures √† l'√©chelle des communes et son √©volution dans le temps.

```{r load-data, include=FALSE}
# Load data
RPG_R53 <- readRDS(here(dir$raw, "RPG_Aggregated_Brittany.rds"))
RPG_R53_wide <- readRDS(here(dir$raw, "RPG_Aggregated_Brittany_wide.rds"))

```

## Le mix cultural en Bretagne: une pr√©sentation g√©n√©rale

### Evolution de la surface agricole en Bretagne

Le graphique ci-dessous montre l'√©volution sur la p√©riode 2007-2023 de la surface agricole totale en Bretagne ainsi que sa distribution entre communes.

```{r agri-area, include=FALSE}
total_agri_per_year <- RPG_R53_wide %>%
  group_by(year) %>%
  summarise(total_ha = sum(as.numeric(surf_agri_geo_unit_m2), na.rm = TRUE) / 10000)

max_violin_y <- RPG_R53 %>% pull(surf_agri_geo_unit_m2) %>% as.numeric() %>% max(na.rm = TRUE) / 10000
max_total_y  <- max(total_agri_per_year$total_ha)
scale_factor <- max_violin_y / max_total_y
total_agri_per_year <- total_agri_per_year %>%
  mutate(scaled_total = total_ha * scale_factor)

```


```{r violin_plot, echo=FALSE, fig.width=10, fig.height=6}

ggplot(RPG_R53_wide, aes(x = factor(year), y = as.numeric(surf_agri_geo_unit_m2) / 10000)) +
  geom_violin(fill = "skyblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, fill = "white", outlier.shape = NA, color = "black") +
  stat_summary(fun = median, geom = "point", color = "blue", size = 2) +
  stat_summary(
    fun = median,
    geom = "text",
    aes(label = round(..y.., 1)),
    vjust = -0.5, color = "blue", size = 2.5
  ) + 
  geom_line(data = total_agri_per_year,
            aes(x = factor(year), y = scaled_total, group = 1),
            color = "red", size = 1.2) +
  geom_point(data = total_agri_per_year,
             aes(x = factor(year), y = scaled_total),
             color = "red", size = 2) +
    geom_text(data = total_agri_per_year,
            aes(x = factor(year), y = scaled_total,
                label = round(total_ha, 0)),
            vjust = -0.7, color = "red", size = 2) +
  scale_y_continuous(
    name = "Surface agricole par commune (ha)",  # Left axis
    sec.axis = sec_axis(~ . / scale_factor, name = "Surface agricole totale (ha)")  # Right axis
  ) +
  labs(title = "Evolution de la surface agricole totale par commune et par ann√©e en Bretagne (2007‚Äì2023)",
       x = "Ann√©e") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Ce graphique montre que la surface agricole utilis√©e totale en Bretagne reste relativement stable dans le temps (ligne rouge). De mani√®re g√©n√©rale, on observe une l√©g√®re d√©croissance de la surface agricole totale, qui a diminu√© de pr√®s de 4% entre 2013 et 2023. 

La distribution de la surface agricole totale par commune montre √©galement une stabilit√© importante (graphiques en violon, et boite √† moustache associ√©e). Pr√®s de 90% des communes en Bretagne ont une surface agricole utilis√©e inf√©rieures √† 3000 ha, et la m√©diane de la surface agricole utilis√©e des communes restent stable dans le temps (environ 1 080 ha).

A noter qu'en agriculture on parle davantage en hectares qu'en m√®tres carr√©s. 
*1 hectare = 10 000 m√®tres carr√©s donc 30 000 000 m√®tres carr√©s = 3000 hectares.

### La sp√©cialisation des cultures en Bretagne

#### Surface agricole par culture

La tableau ci-dessous pr√©sente les surfaces agricoles utilis√©s par culture en Bretagne sur la p√©riode 2007-2023. Il s'agit du total des surfaces par culture sur toutes les parcelles, qui est calcul√© par ann√©e et dont nous pr√©sentons ici la moyenne sur la p√©riode 2007-2023.


```{r desc-stat, include=FALSE}
# Descriptive statistics
RPG_R53_total <- RPG_R53_wide %>% 
  group_by(insee) %>% 
  summarise(
    mean_surf_agri = mean(surf_agri_geo_unit_m2, na.rm = TRUE)
  ) %>% 
  ungroup() %>% 
  summarise(
    total_surf_agri = sum(mean_surf_agri, na.rm = TRUE)
  )

RPG_R53_desc <- RPG_R53 %>% 
  group_by(LIBELLE_GROUPE_CULTURE, insee) %>% 
  summarise(
    mean_surf_ha = mean(surf_code_group_m2, na.rm = TRUE),
    mean_surf_perc = mean(surf_code_group_perc, na.rm = TRUE)
  ) %>% 
  ungroup() %>% 
  group_by(LIBELLE_GROUPE_CULTURE) %>%
  summarise(
    surf_ha = sum(mean_surf_ha, na.rm = TRUE),
    surf_perc = sum(mean_surf_ha, na.rm = TRUE) / RPG_R53_total$total_surf_agri
  ) %>% 
  arrange(desc(surf_ha)) %>% 
  filter(! is.na(LIBELLE_GROUPE_CULTURE))
  

# Calcul de la surface agricole totale (en ha)
total_surf_agri <- sum(RPG_R53_desc$surf_ha)

# Cr√©er une ligne de r√©sum√©
ligne_total <- tibble::tibble(
  LIBELLE_GROUPE_CULTURE = "Surface agricole totale",
  surf_ha = total_surf_agri,
  surf_perc  = NA
)

# Ajouter √† la fin du tableau
df_total <- bind_rows(RPG_R53_desc, ligne_total) %>% 
  arrange(desc(surf_ha)) 

```

```{r desc-stat-table, echo=FALSE, results='asis'}
RPG_R53_desc_clean <- df_total %>%
  mutate(
    surf_ha = as.numeric(surf_ha) / 10000,
    surf_perc = as.numeric(surf_perc) * 100
  ) %>%
  select(LIBELLE_GROUPE_CULTURE, surf_ha, surf_perc) %>%
  rename(
    "Groupe de culture" = LIBELLE_GROUPE_CULTURE,
    "Surface de la culture (ha)" = surf_ha,
    "Part (%)" = surf_perc
  )

knitr::kable(RPG_R53_desc_clean, 
             digits = 1, 
             format = "markdown", 
             align = "lrrr",
             caption = "Utilisation des sols agricoles par culture (moyenne sur la p√©riode 2007‚Äì2023)")

```
*Note : Les surfaces sont exprim√©es en hectares (ha) ; les parts correspondent √† la proportion de chaque culture par rapport √† la surface agricole totale.*

La surface agricole totale est de `r round(as.numeric(total_surf_agri) / 10000, 1)` ha. Notons que le [recensement agricole de 2020](https://draaf.bretagne.agriculture.gouv.fr/agreste-etudes-no4-2021-recensement-agricole-2020-la-bretagne-perd-un-quart-de-a2611.html) reporte une surface agricole totale de 1 624 200 ha, soit une surface `r round(((round(as.numeric(total_surf_agri) / 10000, 1) / 1624200) - 1) * 100,2) ` % plus petite. 

La culture la plus r√©pandue en Bretagne est **le ma√Øs**, qui repr√©sente `r round(RPG_R53_desc$surf_perc[1] * 100, 1)` % de la surface agricole totale. Le ma√Øs est suivi par les **prairies permanentes et temporaires**, qui repr√©sentent respectivement `r round(RPG_R53_desc$surf_perc[2] * 100, 1)` % et `r round(RPG_R53_desc$surf_perc[4] * 100, 1)` % de la surface agricole totale. **Le bl√© tendre, l'orge et les autres c√©r√©ales** compl√®tent le tableau des principales cultures, repr√©sentant respectivement `r round(RPG_R53_desc$surf_perc[3] * 100, 1)` %, `r round(RPG_R53_desc$surf_perc[5] * 100, 1)` % et `r round(RPG_R53_desc$surf_perc[6] * 100, 1)` % de la surface agricole totale.

#### Part de parcelles agricoles par culture

La figure ci-dessous repr√©sente le pourcentage de parcelles agricoles par type de culture en Bretagne pour quatre ann√©es (2007, 2012, 2017 et 2023). Il s'agit du nombre de parcelles par culture divis√© par le nombre total de parcelles recens√©s par le RPG en Bretagne sur l'ann√©e.

```{r nb-parcels, include=FALSE}

year_simplified <- c(2007, 2012, 2017, 2023)

RPG_R53_simplified <- RPG_R53 %>%
  filter(year %in% year_simplified)

# Nombre total de parcelles par ann√©e
N_Parcels_byyear <- RPG_R53_simplified %>% 
  group_by(year) %>%
  summarise(N_Parcels_byyear = sum(parcel_cult_code_group_n))

# Agr√©ger par ann√©e et culture
df_parcelles <- RPG_R53_simplified %>%
  ungroup() %>% 
  left_join(N_Parcels_byyear, by = "year") %>%
  group_by(year, LIBELLE_GROUPE_CULTURE) %>%
  summarise(Share_parcels = sum(parcel_cult_code_group_n, na.rm = TRUE) / N_Parcels_byyear * 100 ) %>% 
  group_by(LIBELLE_GROUPE_CULTURE, year) %>%
  slice(1) %>% 
  ungroup() %>% 
  arrange(year, desc(Share_parcels)) %>% 
  filter(! is.na(LIBELLE_GROUPE_CULTURE)) %>% 
  mutate(LIBELLE_GROUPE_CULTURE = fct_reorder(LIBELLE_GROUPE_CULTURE, Share_parcels, .fun = sum, .desc = TRUE))
  # Take the first row of each group
  


```

```{r nb-parcels-plot, echo=FALSE, fig.width=10, fig.height=6}
ggplot(df_parcelles, aes(x = LIBELLE_GROUPE_CULTURE, y = Share_parcels)) +
  geom_col(fill = "darkgrey") +
  geom_text(aes(label = round(Share_parcels, digits = 3)), hjust = 1.1, color = "black", size = 2) +
  facet_wrap(~ year, ncol = 2) +
  labs(
    title = "Pourcentage de parcelles par type de culture",
    x = "Type de culture",
    y = "Nombre de parcelles"
  ) +
  coord_flip() +
  theme_minimal()

ggsave(here(dir$output, "Pourcentage_parcelles_culture.pdf"), width = 10, height = 6)

```

Nous remarquons que les cultures occupant la tr√®s grande majorit√© des parcelles sur la p√©riode sont aussi celles qui dominent la surface agricole totale. En effet, les **prairies permanentes et temporaires** ainsi que le **ma√Øs** repr√©sentent √† eux seuls plus de 50 % des parcelles agricoles en Bretagne. Le **bl√© tendre**, l'**orge** et les **autres c√©r√©ales** sont √©galement des cultures tr√®s r√©pandues, repr√©sentant respectivement environ 10 % des parcelles agricoles. Le bl√©, l'orge et les autres c√©r√©ales compl√®tent √©galement ce tableau.

Cependant, des cultures moins visibles dans la surface agricole totale paraissent comme plus pr√©sentent en pourcentage de parcelles. Il s'agit de culture cultiv√©e souvent sur des plus petites parcelles, telles que les l√©gumes ou fleurs, et les cultures divers. Si celles-ci repr√©sentent respectivement 3.2% et 1% de la surface agricole totale, elles repr√©sentent 3.9% et 8.9% des parcelles cultiv√©es en Bretagne en 2017.


## Evolution dynamique du mix cultural en Bretagne

Cette section pr√©sente des analyses statistiques visant √† identifier des cultures en d√©veloppement et en d√©clin en Bretagne. Etant donn√© le grand nombre de cat√©gorie de cultures diff√©rentes, et la tr√®s grande domination de la surface agricole pour certaines de ces cultures la comparaison directe de l'√©volution des surfaces n'ait pas rendue facile. Certaines cultures ont des surfaces tr√®s largement sup√©rieur, par exemple la culture de ma√Øs est environ 1 000 fois plus importante en surface que la culture des l√©gumineuses. Le graphique ci-dessous pr√©sente l'√©volution des parts de surfaces agricoles utilis√©es par culture en Bretagne sur la p√©riode 2007-2023. Nous voyons qu'il est d√©licat d'identifier les dynamiques de toutes les cultures √† partir de ce graphique, √©tant donn√© les diff√©rences d'importance/d'√©chelle entre elles.

```{r surf-group-year, include=FALSE}

cultures_groupes_year <- RPG_R53 %>%
  group_by(CODE_GROUP, LIBELLE_GROUPE_CULTURE, year) %>%
  summarise(surface_groupe = sum(surf_code_group_m2)) %>% 
  filter(!is.na(LIBELLE_GROUPE_CULTURE)) %>% 
  ungroup()

surf_tot_year <- RPG_R53 %>% 
  group_by(year, insee) %>%
  slice(1) %>% 
  ungroup() %>% 
  group_by(year) %>%
  summarise(surface_tot = sum(surf_agri_geo_unit_m2)) %>% 
  ungroup()

share_cultures_groupes_year <- cultures_groupes_year %>% 
  left_join(surf_tot_year, by = "year") %>%
  mutate(share_surface_group = surface_groupe / surface_tot * 100, 
         LIBELLE_GROUPE_CULTURE = fct_reorder(LIBELLE_GROUPE_CULTURE, share_surface_group, .fun = sum, .desc = TRUE)) %>% 
  arrange(LIBELLE_GROUPE_CULTURE, year) %>%
  group_by(LIBELLE_GROUPE_CULTURE) %>%
  mutate(growth_share_group = (share_surface_group - lag(share_surface_group)) / lag(share_surface_group) * 100) %>% 
  ungroup()

```
```{r plot-surf-group-year, echo=FALSE, fig.width=10, fig.height=6}

p <- ggplot(share_cultures_groupes_year, aes(
  x = year,
  y = share_surface_group,
  color = LIBELLE_GROUPE_CULTURE,
  group = LIBELLE_GROUPE_CULTURE,
  text = LIBELLE_GROUPE_CULTURE
)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Evolution des parts de surfaces agricoles utilis√©es par culture en Bretagne (2007‚Äì2023)",
    x = "Ann√©e",
    y = "Part de surface agricole utilis√©e"
  ) +
  scale_color_manual(values = c25) +
  theme_minimal() +
  theme(
    legend.position = "bottom",                # Move legend below the plot
    legend.box = "horizontal",                 # Arrange legend items horizontally
    legend.text = element_text(size = 10),     # Optional: adjust label size
    legend.title = element_blank()             # Optional: remove legend title
  ) +
  guides(color = guide_legend(ncol = 3))       # üî• Divide legend into 3 columns

ggplotly(p, tooltip = "text")

```

Nous remarquons ici que la part des surfaces en prairie permanente a plus que tripl√© entre 2014 et 2018, passant de 5,9% √† 20%, tandis que celle de la prairie temporaire a √©t√© divis√© part deux, passant de 30,3% √† 14,7%. La diminution des surfaces en prairies temporaires peut s‚Äôexpliquer en partie par une requalification de ces surfaces
en prairies permanentes. En dehors d'une variation importante de la part des surfaces associ√©es aux prairies, il est d√©licat d'identifier d'autres dynamiques pour les autres cultures sur ce graphique. 

Pour cette raison, nous avons choisi de pr√©senter les √©volutions relatives des surfaces agricoles par culture. Dans un premier temps, nous calculons alors le taux de croissance inter-annuel des surfaces agricoles utilis√©s par la culture, de la mani√®re suivante $g_{kt} = \dfrac{y_{kt} - y_{kt-1}}{y_{kt-1}}$, o√π $g_{kt}$ est le taux de croissance de la culture $k$ √† l'ann√©e $t$, et $y_{kt}$ est la surface agricole utilis√©e par la culture $k$ √† l'ann√©e $t$. Cette analyse permet de comprendre la variabilit√© entre ann√©e des surfaces utilis√©s par la culture.

Dans un second temps, nous calculons la croissance de la surface associ√© √† la culture en base 100, o√π l'ann√©e de r√©f√©rence est celle associ√©e √† l'entr√©e de la culture dans les donn√©es RPG. Ainsi, pour chaque culture, nous calculons la surface agricole utilis√©e par la culture $k$ √† l'ann√©e $t$ divis√© par la surface agricole utilis√©e par la culture $k$ √† l'ann√©e d'entr√©e dans les donn√©es RPG, que nous multiplions par 100. Cette analyse permet de comprendre l'√©volution des surfaces agricoles utilis√©es par la culture depuis son entr√©e dans les donn√©es RPG, et de comparer alors les croissances des surfaces entre culture.

### Analyse des taux de croissance inter-annuels des surfaces agricoles

Le tableau ci-dessous pr√©sente le nombre d'ann√©es de donn√©es ou chaque culture appara√Æt dans notre √©chantillon, ainsi que le taux de croissance annuel moyen des surfaces agricoles utilis√©es par culture sur la p√©riode 2007-2023.

```{r mean-growth-rate,  echo=FALSE, results='asis'}

mean_growthrates <- share_cultures_groupes_year %>% 
  group_by(LIBELLE_GROUPE_CULTURE) %>%
  summarize(n_years = n(),
            mean_growthrate = mean(growth_share_group, na.rm = TRUE))  %>% 
  arrange(desc(mean_growthrate)) %>%
  rename("Groupe de culture" = LIBELLE_GROUPE_CULTURE,
    "Nombre d'ann√©es" = n_years,
    "Taux de croissance annuel moyen" = mean_growthrate)

knitr::kable(mean_growthrates, 
             digits = 1, 
             format = "markdown", 
             align = "lrrr",
             caption = "Taux de croissance annuel moyen des surfaces agricoles par culture sur la p√©riode 2007‚Äì2023")

```


On remarque une tr√®s forte expansion de la vignee, qui chaque ann√©e depuis qu'elle est cultiv√©e en Bretagne (2014) voit sa surface se multiplier par 10,5 en moyenne. Le riz et les plantes √† fibre sont √©galement des cultures en forte expansion, avec un taux de croissance annuel moyen de 113% et 111% respectivement, signifie que leur surface fait plus que doubler chaque ann√©e. A l'inverse, les cultures en d√©clin sont les prairies temporaires, qui ont vu leur surface diminuer de 4,3% par an en moyenne depuis 2007, ainsi que les l√©gumes et fleurs (-1%) et les surfaces gel√©es (-11.7%).

Plus pr√©cis√©ment, il serait int√©ressant de voir o√π le riz et les oliviers ont √©t√© implant√©s en Bretagne, et de quelle mani√®re sont tir√©s ces taux de croissance.


```{r implantations, echo=FALSE, results='asis'}

implantations <- RPG_R53 %>%
  filter(LIBELLE_GROUPE_CULTURE %in% c("Oliviers", "Riz", "Vignes"), year >= 2010) %>%
  group_by(insee, LIBELLE_GROUPE_CULTURE, year) %>%
  slice(1) %>% 
  ungroup() %>% 
  group_by(LIBELLE_GROUPE_CULTURE, year) %>% 
  summarize(
    Nb_communes = n(),
    surf_code_group_m2 = sum(surf_code_group_m2, na.rm = TRUE) / 10000,  # Convert to hectares
  ) %>% 
  ungroup() %>% 
  arrange(LIBELLE_GROUPE_CULTURE, year) %>% 
  rename(
    "Groupe de culture" = LIBELLE_GROUPE_CULTURE,
    "Ann√©e" = year,
    "Nombre de communes d'implantation" = Nb_communes,
    "Surface (ha)" = surf_code_group_m2
  )

knitr::kable(implantations, 
             digits = 1, 
             format = "markdown", 
             align = "lrrr",
             caption = "Implantations des cultures du riz, des oliviers et de la vigne en Bretagne (2010‚Äì2023)")

```


Il faut noter, que la culture du riz et des oliviers sont relativement anecdotiques, en n'√©tant cultiv√©es que dans deux communes pour le riz, et que sur une seule ann√©e pour les oliviers. Dans le cas du riz, le taux de croissance est fortement tir√© par la tentative de culture du riz √† Bain-de-Bretagne sur une ann√©e, arr√™t√©e les ann√©e suivantes. Le cas de la vigne est relativement plus r√©pandue et s'est fortement √©tendue apr√®s 2021, avec plus de 40 communes cultivant de la vigne en 2023 sur environ 60 hectares.

La repr√©sentation graphique ci-dessous montre l'√©volution des taux de croissances annuels √† partir d'une √©chelle en couleur.

```{r heatmap, echo=FALSE, results='asis'}
heatmap_data <- share_cultures_groupes_year 

ggplot(heatmap_data, aes(x = year, y = LIBELLE_GROUPE_CULTURE, fill = log(1 + as.numeric( growth_share_group)/100))) +
  geom_tile() +
  labs(
    title = "Taux de croissance annuelle des surfaces cultiv√©es par culture",
    fill = "Taux de croissance (√©chelle en log)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)
  ) +
  scale_fill_gradientn(
    colours = c("darkblue", "blue", "turquoise",  "yellow", "orange", "red", "purple"),
    na.value = "white"
  )
```

On remarque que les taux de croissance interannuels sont relativement proches pour un grand nombre de culture, et varie peu entre les ann√©e. Cette repr√©sentation a l'avantage d'identifier rapidement les cultures qui repr√©sentent une forte instabilit√© sur la p√©riode comme le riz, les vignes, les l√©gumineuses, les plantes √† fibre, les fruits √† coques, les tournesols et les autres ol√©agineux.

Enfin, le graphique ci-dessous montre l'√©volution du taux de croissance inter-annuel par culture sur la p√©riode 2007-2023.

```{r plot-growth-rate, echo=FALSE, fig.width=10, fig.height=6}

p <- ggplot(filter(share_cultures_groupes_year,
                   !( LIBELLE_GROUPE_CULTURE %in% c("Vignes", "Riz", "Olivier"))),
            aes(
  x = year,
  y = growth_share_group,
  color = LIBELLE_GROUPE_CULTURE,
  group = LIBELLE_GROUPE_CULTURE,
  text = LIBELLE_GROUPE_CULTURE
)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Evolution des taux de croissance des surfaces agricoles utilis√©es \n par culture en Bretagne (2007‚Äì2023), hors olivier, riz et vignes",
    x = "Ann√©e",
    y = "Taux de croissance inter-annuel"
  ) +
  scale_color_manual(values = c25) +
  theme_minimal() +
  theme(
    legend.position = "bottom",                # Move legend below the plot
    legend.box = "horizontal",                 # Arrange legend items horizontally
    legend.text = element_text(size = 10),     # Optional: adjust label size
    legend.title = element_blank()             # Optional: remove legend title
  ) +
  guides(color = guide_legend(ncol = 3))       # Divide legend into 3 columns

ggplotly(p, tooltip = "text")

```

Ce graphique illustre la relative variabilit√© dans l'utilisation des sols agricoles, avec des variations assez importantes d'une ann√©e √† l'autre pour certaines cultures. Les courbes se chevauchant autour de 0 pour les cultures les plus stables, il est plus ais√© de s'attacher aux cultures qui ont tendance √† fluctuer au fil des ann√©es.

Trois cultures ont majoritairement les variations les plus importantes, entre croissance et d√©croissance, c'est-√†-dire entre augmentation de la surface cultiv√©e et diminution, marqu√©es donc par une forme d'instabilit√©: les l√©gumineuses √† grains (courbe bleue claire), le tournesol (courbe fuschia) et les plantes √† fibres (courbe bleu). On remarque √©galement une forte variation du taux de croissance du fourage sur une ann√©e seulement.  

Finalement, notons √©galement l'explosion des autres cultures industrielles et des prot√©agineux en 2023, dont la surface agricole cultiv√©e augmente de plus de 200%.


### Analyse de croissance des surfaces agricoles utilis√©s par culture sur la p√©riode